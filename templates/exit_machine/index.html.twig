{% extends 'base.html.twig' %}

{% block title %}Automat Ausfahrt{% endblock title %}

{% block customCss %}
<link rel="stylesheet" type="text/css" href="{{ libPath }}/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body {
    width: 100%;
    height: 100%;
    /*background-image: url("/projekt-parkhaus/img/parkhaus.jpg");*/
    background-size: cover;
    background-position: top left;
    background-repeat: no-repeat;
}
#wrapper {
    position: absolute;
    width: 720px;
    height: 480px;
    top: calc((100% - 480px) / 2);
    left: calc((100% - 720px) / 2);
    padding: 10px;
    background-color: #c9c9c9;
}
#display {
    background-color: black;
    width: 100%;
    height: 150px;
}
/* Display header */
#display-header {
    padding: 0px 15px;
    line-height: 30px;
    color: navajowhite;
}
#display-header div:nth-child(1) {
    text-align: left;
}
#display-header div:nth-child(2) {
    text-align: center;
}
#display-header div:nth-child(3) {
    text-align: right;
}
/* Display main */
#display-main {
    height: 90px;
    line-height: 30px;
    padding: 0px 15px;
    text-align: center;
    vertical-align: middle;
    color: navajowhite;
}
/* Display footer */
#display-footer {
    padding: 0px 15px;
    line-height: 30px;
    color: navajowhite;
}
</style>
{% endblock customCss %}

{% block htmlBody %}
<div id="wrapper">
    <div class="row">
        <div class="col-12">
            <div id="display">
                <!-- Display header -->
                <div id="display-header" class="row">
                    <div id="display-date" class="col-4">
                        Mo 01.01.1970
                    </div>
                    <div id="display-time" class="col-4">
                        00:00:00
                    </div>
                    <div class="col-4">
                        <i class="fa fa-server"></i>
                        <i class="fa fa-wifi"></i>
                    </div>
                </div>
                <!-- Display main -->
                <div id="display-main" class="row">
                    <div class="col-12">
                        <div id="display-message" style="width: 100%;">Sie haben ausgecheckt!</div>
                        <div style="width: 100%;">Kennzeichen: <span id="display-plate"></span></div>
                    </div>
                </div>
                <!-- Display footer -->
                <div id="display-footer" class="row">
                    <div class="col-12"></div>
                </div>
            </div>
        </div>
        <div class="col-12" style="margin-top: 20px;">
            <label>Kennzeichen mit Zusatz</label>
            <div id="form-group-plate" class="input-group">
                <input type="text" class="form-control" name="district">
                <span class="input-group-text"></span>
                <input type="text" class="form-control" name="custom">
                <span class="input-group-text"></span>
                <input type="text" class="form-control" name="number">
                <span class="input-group-text"></span>
                <select class="custom-select" name="addition">
                    <option value="" selected></option>
                    <option value="E">E</option>
                    <option value="H">H</option>
                </select>
            </div>
        </div>
        <div class="col-12" style="margin-top: 20px; text-align: center;">
            <input type="submit" class="form-control btn btn-default btn-primary" value="Auschecken">
        </div>
    </div>
</div>
{% endblock htmlBody %}

{% block customJs %}
<script type="text/javascript" src="{{ libPath }}/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="{{ libPath }}/js/bootstrap.min.js"></script>
<script type="text/javascript" src="{{ libPath }}/js/LicensePlate.js"></script>
<script type="text/javascript" src="{{ libPath }}/js/Display.js"></script>
<script>
    window.onload = function() {

        var display      = new Display('#display');
        var licensePlate = new LicensePlate();

        display.updateDate();
        display.updateTime();

        window.setInterval(() => {
            display.updateDate();
            display.updateTime();
        }, 250);

        // Event listener: form for license plate
        $('#form-group-plate').find('input, select').on('keyup change', () => {
            let formTarget = $(event.target);
            formTarget.val(formTarget.val().toUpperCase());
            let updateData = {};
            updateData[formTarget.attr('name')] = formTarget.val();

            licensePlate.set(updateData);
            display.setPlate(licensePlate);
        });
    };
</script>
{% endblock customJs %}
